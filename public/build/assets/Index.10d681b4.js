import{p as V}from"./pickBy.a8b9e19a.js";import{t as M}from"./throttle.db181f97.js";import{S as q,m as P}from"./SearchFilter.bfa17a69.js";import{L as $}from"./Layout.1d15fcf9.js";import{M as j}from"./Modal.e396bec6.js";import O from"./Show.cd96d4ef.js";import{P as T}from"./Pagination.67e82f04.js";import F from"./Form.0edcf703.js";import{_ as L,r as d,o as r,c as i,a as s,t as o,b as a,e as h,F as S,j as N,d as m,n as B,h as _,f,w as I}from"./app.7ea1df5b.js";import"./debounce.b4ded49e.js";import"./Dropdown.2fcbf917.js";import"./FlashMessages.f0505d02.js";import"./md5.956d1eed.js";import"./Dialog.8c031e52.js";import"./LoadingButton.2a90a3f5.js";import"./SmsDialog.4f644ad5.js";import"./TextareaInput.d395f10f.js";import"./InputError.fc7f1a6e.js";import"./Show.078f8b0f.js";import"./TextInput.41a9ae3a.js";import"./CheckboxInput.209eae09.js";const R={layout:$,props:{orders:Object,filters:Object},components:{Show:O,Modal:j,Pagination:T,SearchFilter:q,PaymentForm:F},data(){return{order:null,viewModal:!1,add_payment:!1,payment_request:null,form:{search:this.filters.search,trashed:this.filters.trashed}}},watch:{form:{handler:M(function(){let e=V(this.form);this.$inertia.replace(this.route("orders",Object.keys(e).length?e:{remember:"forget"}))},250),deep:!0}},methods:{rowClicked(e){fetch(this.route("orders.ajax",e)).then(n=>{n.json().then(u=>{this.order=u,this.viewModal=!0})})},reset(){this.form=P(this.form,()=>null)},PriorityCol(e){if(e==1)return'<span class="bg-gray-200 rounded text-sm py-1 px-2">'+this.$t("Normal")+"</span>";if(e==2)return'<span class="bg-orange-200 rounded text-sm py-1 px-2">'+this.$t("High")+"</span>";if(e==3)return'<span class="bg-red-200 rounded text-sm py-1 px-2">'+this.$t("Urgent")+"</span>"},addPayment(e){this.payment_request||(this.payment_request={}),this.payment_request.customer={value:e.customer.id,label:e.customer.name},this.payment_request.order=e,this.add_payment=!0}}},U={class:"w-100"},H={class:"mb-6 mt-2 font-bold text-lg md:text-2xl"},A={class:"np mb-6 flex justify-between items-center"},D={class:"block text-gray-700"},z={class:"mt-4 block text-gray-700"},E={class:"inline md:hidden"},G={class:"hidden md:inline"},W={class:"bg-white rounded shadow overflow-x-auto scroll-on-light overflow-y-hidden"},J={class:"w-full whitespace-no-wrap"},K={class:"text-left font-bold"},Q={class:"px-6 pt-6 pb-4"},X={class:"px-6 pt-6 pb-4"},Y={class:"px-6 pt-6 pb-4"},Z={class:"px-6 pt-6 pb-4"},ee={class:"px-6 pt-6 pb-4",colspan:"2"},te=["onClick"],se={class:"border-t px-6 py-4 leading-normal"},oe={class:"flex items-center"},le={key:0},ne={class:"border-t px-6 py-4 leading-normal"},re={key:0},ae={class:"border-t px-6 py-4 leading-normal"},ie={key:0},de={class:"border-t px-6 py-4 leading-normal"},me=["innerHTML"],ue={key:1,class:"pt-3"},ce={class:"border-t font-bold pl-6 py-4 leading-normal"},pe={class:"inline-flex items-center justify-end"},he=["onClick"],_e={class:"border-t px-4 w-6"},fe={class:"flex items-center"},ye={key:0},be={class:"border-t px-6 py-4",colspan:"6"};function ve(e,n,u,we,l,p){const y=d("v-select"),v=d("search-filter"),c=d("Icons"),w=d("Link"),g=d("pagination"),k=d("Show"),b=d("Modal"),x=d("PaymentForm");return r(),i("div",U,[s("div",null,[s("h1",H,o(e.$tc("Order",2)),1),s("div",A,[a(v,{modelValue:l.form.search,"onUpdate:modelValue":n[2]||(n[2]=t=>l.form.search=t),class:"w-full max-w-md ltr:mr-4 rtl:ml-4",onReset:p.reset},{default:h(()=>[s("label",D,o(e.$tc("Delivery",2)),1),a(y,{modelValue:l.form.due_in,"onUpdate:modelValue":n[0]||(n[0]=t=>l.form.due_in=t),options:[{value:"",label:e.$t("All")},{value:"2",label:e.$t("due_in_x",{x:2})},{value:"7",label:e.$t("due_in_x",{x:7})},{value:"14",label:e.$t("due_in_x",{x:14})}],reduce:t=>t.value},null,8,["modelValue","options","reduce"]),s("label",z,o(e.$t("Trashed")),1),a(y,{modelValue:l.form.trashed,"onUpdate:modelValue":n[1]||(n[1]=t=>l.form.trashed=t),options:[{value:"",label:"Not Trashed"},{value:"with",label:e.$t("With Trashed")},{value:"only",label:e.$t("Only Trashed")}],reduce:t=>t.value},null,8,["modelValue","options","reduce"])]),_:1},8,["modelValue","onReset"]),a(w,{class:"btn-gray",href:e.route("orders.new")},{default:h(()=>[s("span",E,[a(c,{name:"add",class:"w-4 h-4 fill-white group-hover:fill-white"})]),s("span",G,o(e.$t("create_x",{x:e.$tc("Order")})),1)]),_:1},8,["href"])]),s("div",W,[s("table",J,[s("thead",null,[s("tr",K,[s("th",Q,o(e.$tc("Order")),1),s("th",X,o(e.$tc("Customer")),1),s("th",Y,o(e.$t("Assigned to & delivery")),1),s("th",Z,o(e.$t("Status")),1),s("th",ee,o(e.$t("Grand Total")),1)])]),s("tbody",null,[(r(!0),i(S,null,N(u.orders.data,t=>(r(),i("tr",{key:t.id,onClick:C=>p.rowClicked(t.id),class:B(["cursor-pointer hover:bg-teal-200 focus-within:bg-teal-200",{"bg-red-300":t.status!="Ready"&&t.status!="Completed"&&t.due_passed}])},[s("td",se,[s("div",oe,[_(o(e.$datetime(t.created_at))+" ",1),t.deleted_at?(r(),f(c,{key:0,name:"trash",class:"flex-shrink-0 w-3 h-3 fill-gray-400 ml-2"})):m("",!0)]),s("div",null,o(e.$t("Ref"))+": "+o(e.$reference(t.reference)),1),t.user?(r(),i("div",le,o(e.$t("by"))+" "+o(t.user.name),1)):m("",!0)]),s("td",ne,[t.customer?(r(),i("div",re,[_(o(t.customer.name)+" ",1),s("div",null,o(t.customer.phone),1)])):m("",!0)]),s("td",ae,[t.assigned_to?(r(),i("div",ie,o(t.assigned_to.name),1)):m("",!0),s("div",null,o(e.$date(t.delivery_date)),1)]),s("td",de,[s("div",null,o(e.$t(t.status)),1),t.priority?(r(),i("div",{key:0,class:"pt-3",innerHTML:p.PriorityCol(t.priority)},null,8,me)):m("",!0),t.due?(r(),i("div",ue,o(t.due),1)):m("",!0)]),s("td",ce,[s("div",pe,[t.paid?(r(),f(c,{key:0,name:"check",class:"flex-shrink-0 w-3 h-3 fill-green-600 ltr:mr-2 rtl:ml-2"})):(r(),i("a",{key:1,onClick:I(C=>p.addPayment(t),["stop"]),class:"p-1 text-green-700"},[a(c,{name:"add",class:"flex-shrink-0 w-3 h-3 fill-current ml-2"})],8,he)),_(" "+o(e.$number(t.grand_total))+" ",1)])]),s("td",_e,[s("div",fe,[a(c,{name:"cheveron-right",class:"block w-6 h-6 fill-gray-400 rtl:rotate"})])])],10,te))),128)),u.orders.data.length===0?(r(),i("tr",ye,[s("td",be,o(e.$t("no_x_found",{x:e.$tc("Order")})),1)])):m("",!0)])])]),a(g,{links:u.orders.links,meta:u.orders.meta},null,8,["links","meta"])]),a(b,{show:l.viewModal,"max-width":"2xl",closeable:!0,onClose:n[4]||(n[4]=()=>l.viewModal=!1)},{default:h(()=>[a(k,{order:l.order,onClose:n[3]||(n[3]=()=>l.viewModal=!1)},null,8,["order"])]),_:1},8,["show"]),a(b,{show:l.add_payment,"max-width":"2xl",closeable:!0,onClose:n[6]||(n[6]=()=>l.add_payment=!1)},{default:h(()=>[l.payment_request?(r(),f(x,{key:0,c:l.payment_request.customer,oId:l.payment_request.order.id,amount:l.payment_request.order.grand_total,onClose:n[5]||(n[5]=()=>l.add_payment=!1)},null,8,["c","oId","amount"])):m("",!0)]),_:1},8,["show"])])}const Ae=L(R,[["render",ve]]);export{Ae as default};

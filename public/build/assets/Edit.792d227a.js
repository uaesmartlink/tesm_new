import{L as G}from"./Layout.4bfd1520.js";import{g as N}from"./debounce.8dd135a4.js";import{T as H}from"./TextInput.272dd0b4.js";import{d as K}from"./DeleteMixin.c32b20e6.js";import{R as Q}from"./RadioInput.7a0090a5.js";import{S as W}from"./SelectInput.e3d5dd09.js";import{C as X}from"./CheckboxInput.49c752d4.js";import{T as Y}from"./TextareaInput.cb130151.js";import{L as Z}from"./LoadingButton.4662800a.js";import{T as ee}from"./TrashedMessage.b44dd8a7.js";import{D as re}from"./DeleteRestoreComponent.30e404f8.js";import{_ as se,r as c,o,c as m,a,b as d,e as v,h as g,t as i,f as y,d as f,w as te,n as B,m as le,D as oe,F as b,j as k}from"./app.c5427762.js";import"./Dropdown.be818878.js";import"./FlashMessages.12b966dd.js";import"./InputError.09d028da.js";import"./Dialog.827d4eaf.js";import"./Modal.a0325032.js";const me={layout:G,remember:"form",mixins:[K("measurement")],props:{measurement:Object,iservices:Array},components:{CheckboxInput:X,LoadingButton:Z,RadioInput:Q,SelectInput:W,TextInput:H,TextareaInput:Y,TrashedMessage:ee,DeleteRestoreComponent:re},metaInfo(){return{title:this.$t("edit_x",{x:this.form.name})}},data(){return{restore:!1,sending:!1,form:{name:this.measurement.name,service_id:this.measurement.service.id,customer_id:this.measurement.customer.id,measurement:this.measurement.measurement,price:this.measurement.price,appointment:this.measurement.appointment},service:{value:this.measurement.service.id,label:this.measurement.service.name,measurement_fields:this.measurement.service.measurement_fields},customer:{label:this.measurement.customer.name,value:this.measurement.customer.id},services:[],customers:[]}},watch:{customer:function(e,s){this.form.customer_id=e?e.value:null,(!this.form.name||this.service&&this.form.name==this.service.label||this.form.name==(s?s.label+"'s ":"")+(this.service?this.service.label:""))&&(this.form.name=(e?e.label:"")+(this.service?"'s "+this.service.label:""))},service:function(e,s){this.form.service_id=e?e.value:null,(!this.form.name||this.customer&&this.form.name==this.customer.label||this.form.name==(this.customer?this.customer.label+"'s ":"")+(s?s.label:""))&&(this.form.name=(this.customer?this.customer.label+"'s ":"")+(e?e.label:"")),s&&s.measurement_fields.map(l=>{delete this.form[l.name]}),e&&e.measurement_fields.map(l=>{l.type=="Checkbox"?(this.form[l.name]={},l.options.map(p=>this.form[l.name][p.value]=!1)):this.form[l.name]=null})}},created(){this.service.measurement_fields.map((e,s)=>{if(this.measurement.extra_attributes&&this.measurement.extra_attributes.length){let l=this.measurement.extra_attributes.find(p=>Object.keys(p)[0]==e.name);e.type=="Checkbox"?l?this.form[e.name]=JSON.parse(l[e.name]):(this.form[e.name]={},e.options.map(p=>this.form[e.name][p.value]=!1)):this.form[e.name]=l?l[e.name]+"":""}else e.type=="Checkbox"?(this.form[e.name]={},e.options.map(l=>this.form[e.name][l.value]=!1)):this.form[e.name]=null})},mounted(){this.customers=[this.customer],this.services=[...this.iservices,this.service]},methods:{submit(){this.sending=!0;let e={...this.form};if(this.service.measurement_fields&&this.service.measurement_fields.length>0){let s=[];this.service.measurement_fields.map((l,p)=>{delete e[l.name];let t={};t[l.name]=l.type=="Checkbox"?JSON.stringify(this.form[l.name]):this.form[l.name],s[p]={...t}}),e.extra_attributes=[...s]}this.$inertia.put(this.route("measurements.update",this.measurement.id),e,{onFinish:()=>this.sending=!1})},updateFormValue(e,s,l){l?this.form[s][l]=!!e:this.form[s]=e&&e.target&&e.target.value?e.target.value:e},searchCustomers(e,s){e&&(s(!0),this.searchingCustomers(s,e,this))},searchingCustomers:N((e,s,l)=>{fetch(l.route("ajax.customers")+"?search="+s).then(p=>{p.json().then(t=>l.customers=t),e(!1)})},350),searchServices(e,s){e&&(s(!0),this.searchingServices(s,e,this))},searchingServices:N((e,s,l)=>{fetch(l.route("ajax.services")+"?with_fields=1&search="+s).then(p=>{p.json().then(t=>l.services=t),e(!1)})},350)}},ae={class:"mb-6 mt-2 font-bold text-lg md:text-2xl"},ne=a("span",{class:"text-gray-400 font-medium mx-2"},"/",-1),ie={class:"bg-white rounded shadow overflow-hidden max-w-3xl"},ue={class:"p-8 ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 -mb-8 flex flex-wrap"},pe={class:"px-8 pb-8 ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 -mb-8 flex flex-wrap"},ce={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},de={class:"form-label",for:"customer_id"},he={key:0,class:"form-error"},fe={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},_e={class:"form-label",for:"service_id"},be={key:0,class:"form-error"},ve={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},ge={class:"form-label",for:"price"},ye={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},ke={class:"form-label",for:"appointment"},Ve={key:0,class:"ltr:pr-6 rtl:pl-6 ltr:-mr-12 rtl:-ml-12 w-full"},we={class:"font-bold mb-2"},xe=a("hr",{class:"mb-8"},null,-1),Ce={class:"ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 col-span-full grid grid-cols-1 sm:grid-cols-2"},Se=["value"],Ue=a("div",{class:"py-2"},null,-1),Te={key:0,class:"form-error"},Ie=a("div",{class:"py-2"},null,-1),Me={key:0,class:"form-error"},De={class:"px-8 py-4 bg-gray-100 border-t border-gray-200 flex items-center"};function Re(e,s,l,p,t,_){var S,U,T,I,M,D,R,j,F,L;const $=c("Icons"),O=c("Link"),A=c("trashed-message"),V=c("text-input"),x=c("v-select"),E=c("select-input"),C=c("textarea-input"),J=c("checkbox-input"),z=c("radio-input"),P=c("DeleteRestoreComponent"),q=c("loading-button");return o(),m("div",null,[a("h1",ae,[d(O,{class:"text-gray-600 hover:text-gray-800 inline-flex items-center",href:e.route("measurements")},{default:v(()=>[d($,{name:"back",class:"flex-shrink-0 w-3 h-3 md:w-5 md:h-5 fill-current ltr:mr-2 rtl:ml-2 rtl:rotate"}),g(" "+i(e.$tc("Measurement",2)),1)]),_:1},8,["href"]),ne,g(" "+i(t.form.name),1)]),l.measurement.deleted_at?(o(),y(A,{key:0,class:"mb-6",onRestore:s[0]||(s[0]=()=>t.restore=!0)},{default:v(()=>[g(i(e.$t("already_deleted_x",{x:e.$tc("Measurement")})),1)]),_:1})):f("",!0),a("div",ie,[a("form",{onSubmit:s[8]||(s[8]=te((...r)=>_.submit&&_.submit(...r),["prevent"])),autocomplete:"off"},[a("div",ue,[d(V,{modelValue:t.form.name,"onUpdate:modelValue":s[1]||(s[1]=r=>t.form.name=r),errors:(S=e.$page.props.errors)==null?void 0:S.name,class:"ltr:pr-6 rtl:pl-6 pb-8 w-full",label:e.$t("Type Name")},null,8,["modelValue","errors","label"])]),a("div",pe,[a("div",ce,[a("label",de,i(e.$tc("Customer")),1),d(x,{transition:"",modelValue:t.customer,"onUpdate:modelValue":s[2]||(s[2]=r=>t.customer=r),options:t.customers,"input-id":"customer_id",onSearch:_.searchCustomers,dir:e.$page.props.user.account.direction,placeholder:e.$t("search_x",{x:e.$tc("Customer",2)}),class:B({error:((U=e.$page.props.errors)==null?void 0:U.customer_id)&&((T=e.$page.props.errors)==null?void 0:T.customer_id.length)})},null,8,["modelValue","options","onSearch","dir","placeholder","class"]),(I=e.$page.props.errors)!=null&&I.customer_id?(o(),m("div",he,i((M=e.$page.props.errors)==null?void 0:M.customer_id[0]),1)):f("",!0)]),a("div",fe,[a("label",_e,i(e.$tc("Service")),1),d(x,{transition:"",modelValue:t.service,"onUpdate:modelValue":s[3]||(s[3]=r=>t.service=r),options:t.services,"input-id":"service_id",onSearch:_.searchServices,dir:e.$page.props.user.account.direction,placeholder:e.$t("search_x",{x:e.$tc("Service",2)}),class:B({error:((D=e.$page.props.errors)==null?void 0:D.service_id)&&((R=e.$page.props.errors)==null?void 0:R.service_id.length)})},null,8,["modelValue","options","onSearch","dir","placeholder","class"]),(j=e.$page.props.errors)!=null&&j.service_id?(o(),m("div",be,i((F=e.$page.props.errors)==null?void 0:F.service_id[0]),1)):f("",!0)]),a("div",ve,[a("label",ge,i(e.$tc("Price")),1),d(V,{type:"number",modelValue:t.form.price,"onUpdate:modelValue":s[4]||(s[4]=r=>t.form.price=r)},null,8,["modelValue"])]),a("div",ye,[a("label",ke,i(e.$tc("Appointment Time")),1),le(a("input",{type:"datetime-local",name:"appointment","onUpdate:modelValue":s[5]||(s[5]=r=>t.form.appointment=r)},null,512),[[oe,t.form.appointment]])]),t.service&&t.service.measurement_fields&&t.service.measurement_fields.length?(o(),m("div",Ve,[a("h1",we,i(e.$tc("Measurement Field",2)),1),xe,a("div",Ce,[(o(!0),m(b,null,k(t.service.measurement_fields,(r,u)=>(o(),m(b,null,[r.type=="Text"?(o(),m("div",{key:"in_"+u},[d(V,{label:r.name,modelValue:t.form[r.name],"onUpdate:modelValue":n=>t.form[r.name]=n,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6 pb-8"},null,8,["label","modelValue","onUpdate:modelValue","errors"])])):r.type=="Select"?(o(),m("div",{key:"in_"+u},[d(E,{label:r.name,modelValue:t.form[r.name],"onUpdate:modelValue":n=>t.form[r.name]=n,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6"},{default:v(()=>[(o(!0),m(b,null,k(r.options,(n,h)=>(o(),m("option",{key:"o_"+h,value:n.value},i(n.value),9,Se))),128))]),_:2},1032,["label","modelValue","onUpdate:modelValue","errors"])])):r.type=="Textarea"?(o(),m("div",{key:"in_"+u,class:"col-span-full"},[(o(),y(C,{label:r.name,key:"in_"+u,modelValue:t.form[r.name],"onUpdate:modelValue":n=>t.form[r.name]=n,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6 pb-8 w-full"},null,8,["label","modelValue","onUpdate:modelValue","errors"]))])):r.type=="Checkbox"?(o(),m("div",{key:"in_"+u},[(o(),m("div",{class:"ltr:text-left rtl:text-right ltr:pr-6 rtl:pl-6 mb-8",key:"in_"+u},[(o(),m("label",{class:"form-label mr-6",key:"in_"+u},i(r.name),1)),Ue,(o(!0),m(b,null,k(r.options,(n,h)=>(o(),y(J,{label:n.value,class:"mb-2 w-full",id:"cb_"+h+"_"+u,key:"cb_"+h+"_"+u,value:t.form[r.name][n.value],errors:e.$page.props.errors[r.name],checked:t.form[r.name][n.value]==!0,"onUpdate:checked":w=>_.updateFormValue(w,r.name,n.value)},null,8,["label","id","value","errors","checked","onUpdate:checked"]))),128)),e.$page.props.errors[r.name]&&e.$page.props.errors[r.name].length?(o(),m("div",Te,i(e.$page.props.errors[r.name][0]),1)):f("",!0)]))])):r.type=="Radio"?(o(),m("div",{key:"in_"+u},[(o(),m("div",{class:"ltr:text-left rtl:text-right ltr:pr-6 rtl:pl-6 mb-8",key:"in_"+u},[(o(),m("label",{class:"form-label mr-6",key:"in_"+u},i(r.name),1)),Ie,(o(!0),m(b,null,k(r.options,(n,h)=>(o(),y(z,{name:r.name,label:n.value,value:n.value,class:"mb-2 w-full mr-6",id:"r_"+h+"_"+u,key:"r_"+h+"_"+u,checked:n.value==t.form[r.name],errors:e.$page.props.errors[r.name],onInput:w=>_.updateFormValue(w,r.name)},null,8,["name","label","value","id","checked","errors","onInput"]))),128)),e.$page.props.errors[r.name]&&e.$page.props.errors[r.name].length?(o(),m("div",Me,i(e.$page.props.errors[r.name][0]),1)):f("",!0)]))])):f("",!0)],64))),256))])])):f("",!0),d(C,{high:"",label:e.$t("Description"),modelValue:t.form.measurement,"onUpdate:modelValue":s[6]||(s[6]=r=>t.form.measurement=r),errors:(L=e.$page.props.errors)==null?void 0:L.measurement,class:"ltr:pr-6 rtl:pl-6 pb-8 w-full"},null,8,["label","modelValue","errors"])]),a("div",De,[d(P,{restore:t.restore,data:l.measurement,model:"Measurement",routeM:"measurements",onCloseRestore:s[7]||(s[7]=()=>t.restore=!1)},null,8,["restore","data"]),d(q,{loading:t.sending,class:"btn-gray ltr:ml-auto rtl:mr-auto",type:"submit"},{default:v(()=>[g(i(e.$t("update_x",{x:e.$tc("Measurement")})),1)]),_:1},8,["loading"])])],32)])])}const We=se(me,[["render",Re]]);export{We as default};
